<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RAGEBAITER - Master the Art of Response</title>
    <script src="https://js.puter.com/v2/"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #8cb369;
            --secondary: #f4e285;
            --accent: #f4a259;
            --neutral: #5b8e7d;
            --danger: #bc4b51;
            --bg: linear-gradient(135deg, #8cb369 0%, #f4e285 25%, #f4a259 50%, #5b8e7d 75%, #bc4b51 100%);
            --card-bg: rgba(255, 255, 255, 0.95);
            --text: #2c2c2c;
            --text-light: #666666;
            --border: rgba(140, 179, 105, 0.3);
            --hover: rgba(244, 226, 133, 0.3);
            --glass: rgba(255, 255, 255, 0.1);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif;
            background: var(--bg);
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
            color: var(--text);
            line-height: 1.6;
            min-height: 100vh;
            overflow-x: hidden;
        }

        @keyframes gradientShift {
            0%, 100% { background-position: 0% 50%; }
            25% { background-position: 100% 50%; }
            50% { background-position: 100% 100%; }
            75% { background-position: 0% 100%; }
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 0 20px;
            position: relative;
            z-index: 1;
        }

        /* Animated Background Elements */
        .bg-elements {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
            overflow: hidden;
        }

        .floating-orb {
            position: absolute;
            border-radius: 50%;
            filter: blur(1px);
            animation: floatOrb 20s infinite linear;
        }

        .orb-1 {
            width: 120px;
            height: 120px;
            background: radial-gradient(circle, var(--primary), transparent);
            top: 10%;
            left: 10%;
            animation-delay: 0s;
        }

        .orb-2 {
            width: 80px;
            height: 80px;
            background: radial-gradient(circle, var(--accent), transparent);
            top: 60%;
            left: 80%;
            animation-delay: -8s;
        }

        .orb-3 {
            width: 100px;
            height: 100px;
            background: radial-gradient(circle, var(--secondary), transparent);
            top: 30%;
            left: 70%;
            animation-delay: -4s;
        }

        .orb-4 {
            width: 60px;
            height: 60px;
            background: radial-gradient(circle, var(--neutral), transparent);
            top: 80%;
            left: 20%;
            animation-delay: -12s;
        }

        .orb-5 {
            width: 90px;
            height: 90px;
            background: radial-gradient(circle, var(--danger), transparent);
            top: 40%;
            left: 5%;
            animation-delay: -16s;
        }

        @keyframes floatOrb {
            0% {
                transform: translateY(100vh) translateX(0) rotate(0deg) scale(0.5);
                opacity: 0;
            }
            10% {
                opacity: 0.8;
                transform: translateY(90vh) translateX(20px) rotate(36deg) scale(0.8);
            }
            90% {
                opacity: 0.8;
                transform: translateY(-10vh) translateX(-20px) rotate(324deg) scale(1.2);
            }
            100% {
                transform: translateY(-20vh) translateX(0) rotate(360deg) scale(0.5);
                opacity: 0;
            }
        }

        .geometric-shape {
            position: absolute;
            animation: geometricFloat 25s infinite linear;
        }

        .triangle {
            width: 0;
            height: 0;
            border-left: 15px solid transparent;
            border-right: 15px solid transparent;
            border-bottom: 26px solid var(--accent);
            top: 20%;
            left: 90%;
            opacity: 0.4;
            animation-delay: -5s;
        }

        .square {
            width: 20px;
            height: 20px;
            background: var(--primary);
            top: 70%;
            left: 85%;
            opacity: 0.4;
            animation-delay: -10s;
            transform: rotate(45deg);
        }

        .diamond {
            width: 25px;
            height: 25px;
            background: var(--danger);
            transform: rotate(45deg);
            top: 50%;
            left: 5%;
            opacity: 0.4;
            animation-delay: -15s;
        }

        @keyframes geometricFloat {
            0% {
                transform: translateY(100vh) rotate(0deg);
                opacity: 0.4;
            }
            100% {
                transform: translateY(-100px) rotate(720deg);
                opacity: 0;
            }
        }

        /* Header */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 3rem 0 2rem;
            position: relative;
            z-index: 10;
            backdrop-filter: blur(10px);
            background: var(--glass);
            border-radius: 20px;
            margin: 20px 0;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 0 2rem;
        }

        .logo-icon {
            width: 60px;
            height: 60px;
            background: linear-gradient(45deg, var(--primary), var(--accent));
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 900;
            font-size: 1.5rem;
            animation: logoRotate 4s ease-in-out infinite;
            box-shadow: 0 10px 25px rgba(140, 179, 105, 0.4);
            position: relative;
            overflow: hidden;
        }

        .logo-icon::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.3), transparent);
            transform: rotate(45deg);
            animation: shine 3s ease-in-out infinite;
        }

        @keyframes logoRotate {
            0%, 100% { transform: scale(1) rotate(0deg); }
            25% { transform: scale(1.1) rotate(5deg); }
            50% { transform: scale(1.05) rotate(0deg); }
            75% { transform: scale(1.1) rotate(-5deg); }
        }

        @keyframes shine {
            0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
            50% { transform: translateX(100%) translateY(100%) rotate(45deg); }
            100% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
        }

        .logo-text {
            font-size: 2.2rem;
            font-weight: 900;
            background: linear-gradient(45deg, var(--primary), var(--accent), var(--danger));
            background-size: 200% 200%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: textGradient 3s ease-in-out infinite;
            letter-spacing: -0.02em;
        }

        @keyframes textGradient {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        .logo-subtitle {
            font-size: 0.9rem;
            color: var(--neutral);
            font-weight: 600;
            margin-top: 0.3rem;
            animation: fadeInOut 4s ease-in-out infinite;
        }

        @keyframes fadeInOut {
            0%, 100% { opacity: 0.7; }
            50% { opacity: 1; }
        }

        .auth-section {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 0 2rem;
        }

        .login-btn, .logout-btn {
            padding: 1rem 2rem;
            border: 2px solid var(--primary);
            border-radius: 25px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 1rem;
            background: linear-gradient(45deg, var(--primary), var(--accent));
            color: white;
            position: relative;
            overflow: hidden;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .login-btn::before, .logout-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            transition: left 0.5s;
        }

        .login-btn:hover::before, .logout-btn:hover::before {
            left: 100%;
        }

        .login-btn:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 15px 35px rgba(140, 179, 105, 0.4);
        }

        .logout-btn {
            background: linear-gradient(45deg, var(--danger), var(--accent));
            border-color: var(--danger);
        }

        .logout-btn:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 15px 35px rgba(188, 75, 81, 0.4);
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem 1.5rem;
            background: var(--card-bg);
            border-radius: 30px;
            border: 2px solid var(--secondary);
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 25px rgba(244, 226, 133, 0.3);
            animation: userInfoPulse 3s ease-in-out infinite;
        }

        @keyframes userInfoPulse {
            0%, 100% { box-shadow: 0 8px 25px rgba(244, 226, 133, 0.3); }
            50% { box-shadow: 0 12px 35px rgba(244, 226, 133, 0.5); }
        }

        .status-dot {
            width: 12px;
            height: 12px;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            border-radius: 50%;
            animation: statusBeat 2s ease-in-out infinite;
            box-shadow: 0 0 10px var(--primary);
        }

        @keyframes statusBeat {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.3); }
        }

        /* Main Content */
        .main-content {
            position: relative;
            z-index: 10;
            margin-bottom: 4rem;
        }

        .input-section {
            background: var(--card-bg);
            border-radius: 25px;
            padding: 3rem;
            border: 2px solid var(--secondary);
            margin-bottom: 3rem;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            backdrop-filter: blur(15px);
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
        }

        .input-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, var(--primary), var(--secondary), var(--accent), var(--neutral), var(--danger));
            background-size: 200% 100%;
            animation: borderFlow 3s linear infinite;
        }

        @keyframes borderFlow {
            0% { background-position: 0% 0%; }
            100% { background-position: 200% 0%; }
        }

        .input-section:hover {
            transform: translateY(-5px);
            box-shadow: 0 30px 70px rgba(0, 0, 0, 0.15);
            border-color: var(--accent);
        }

        .input-label {
            display: block;
            font-weight: 700;
            margin-bottom: 1.5rem;
            color: var(--neutral);
            font-size: 1.2rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            position: relative;
        }

        .input-label::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 0;
            width: 60px;
            height: 3px;
            background: linear-gradient(90deg, var(--primary), var(--accent));
            border-radius: 2px;
        }

        .context-input {
            width: 100%;
            padding: 1.5rem;
            border: 3px solid var(--border);
            border-radius: 20px;
            font-size: 1.1rem;
            resize: vertical;
            min-height: 140px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-family: inherit;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
        }

        .context-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 5px rgba(140, 179, 105, 0.2);
            transform: scale(1.02);
            background: white;
        }

        .generate-btn {
            margin-top: 2rem;
            width: 100%;
            padding: 1.5rem 2rem;
            background: linear-gradient(45deg, var(--primary), var(--accent), var(--secondary));
            background-size: 200% 200%;
            color: white;
            border: none;
            border-radius: 20px;
            font-size: 1.2rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            text-transform: uppercase;
            letter-spacing: 1px;
            animation: buttonGlow 4s ease-in-out infinite;
        }

        @keyframes buttonGlow {
            0%, 100% { background-position: 0% 50%; box-shadow: 0 8px 30px rgba(140, 179, 105, 0.3); }
            50% { background-position: 100% 50%; box-shadow: 0 12px 40px rgba(244, 162, 89, 0.4); }
        }

        .generate-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            transition: left 0.5s;
        }

        .generate-btn:not(:disabled):hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 20px 50px rgba(140, 179, 105, 0.4);
        }

        .generate-btn:not(:disabled):hover::before {
            left: 100%;
        }

        .generate-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .btn-loader {
            width: 24px;
            height: 24px;
            border: 3px solid rgba(255,255,255,0.3);
            border-top: 3px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Response Cards */
        .responses-title {
            text-align: center;
            font-size: 2.5rem;
            font-weight: 900;
            margin-bottom: 3rem;
            background: linear-gradient(45deg, var(--primary), var(--accent), var(--danger));
            background-size: 200% 200%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: titlePulse 3s ease-in-out infinite;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        @keyframes titlePulse {
            0%, 100% { background-position: 0% 50%; transform: scale(1); }
            50% { background-position: 100% 50%; transform: scale(1.05); }
        }

        .responses-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 2rem;
        }

        .response-card {
            background: var(--card-bg);
            border-radius: 25px;
            padding: 2rem;
            border: 3px solid var(--border);
            position: relative;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            animation: cardSlideIn 0.8s ease-out;
            animation-fill-mode: both;
            backdrop-filter: blur(15px);
            overflow: hidden;
        }

        .response-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, var(--primary), var(--secondary), var(--accent));
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: -1;
        }

        .response-card:hover::before {
            opacity: 0.1;
        }

        .response-card:nth-child(1) { 
            animation-delay: 0.1s; 
            border-color: var(--primary);
        }
        .response-card:nth-child(2) { 
            animation-delay: 0.3s; 
            border-color: var(--accent);
        }
        .response-card:nth-child(3) { 
            animation-delay: 0.5s; 
            border-color: var(--danger);
        }

        @keyframes cardSlideIn {
            from {
                opacity: 0;
                transform: translateY(50px) scale(0.8);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .response-card:hover {
            transform: translateY(-10px) scale(1.03);
            box-shadow: 0 25px 60px rgba(0,0,0,0.15);
        }

        .method-badge {
            background: linear-gradient(45deg, var(--secondary), var(--accent));
            color: var(--text);
            padding: 0.8rem 1.2rem;
            border-radius: 25px;
            font-weight: 700;
            font-size: 0.8rem;
            margin-bottom: 1.5rem;
            display: inline-block;
            border: 2px solid var(--accent);
            box-shadow: 0 5px 20px rgba(244, 162, 89, 0.3);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            animation: badgeFloat 3s ease-in-out infinite;
        }

        @keyframes badgeFloat {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-3px); }
        }

        .response-content {
            font-size: 1.1rem;
            line-height: 1.7;
            margin-bottom: 2rem;
            color: var(--text);
            background: linear-gradient(135deg, var(--hover), rgba(244, 226, 133, 0.1));
            padding: 1.5rem;
            border-radius: 15px;
            border-left: 5px solid var(--accent);
            font-weight: 500;
            position: relative;
            overflow: hidden;
        }

        .response-content::before {
            content: '"';
            position: absolute;
            top: -10px;
            left: 10px;
            font-size: 3rem;
            color: var(--accent);
            opacity: 0.3;
            font-family: serif;
        }

        .copy-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.8rem;
            padding: 1rem 1.5rem;
            background: linear-gradient(45deg, var(--neutral), var(--primary));
            color: white;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            font-weight: 700;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 1rem;
            width: 100%;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            position: relative;
            overflow: hidden;
        }

        .copy-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: left 0.4s;
        }

        .copy-btn:hover {
            transform: translateY(-2px) scale(1.05);
            box-shadow: 0 10px 30px rgba(91, 142, 125, 0.4);
        }

        .copy-btn:hover::before {
            left: 100%;
        }

        .copy-btn.copied {
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            animation: copySuccess 0.6s ease;
        }

        @keyframes copySuccess {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        /* Toast */
        .toast {
            position: fixed;
            top: 2rem;
            right: 2rem;
            background: linear-gradient(45deg, var(--neutral), var(--primary));
            color: white;
            padding: 1.5rem 2rem;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            z-index: 1000;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            font-weight: 700;
            transform: translateX(120%);
            border: 2px solid rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(10px);
        }

        .toast.show {
            transform: translateX(0);
            animation: toastPulse 0.6s ease;
        }

        @keyframes toastPulse {
            0% { transform: translateX(0) scale(0.8); }
            50% { transform: translateX(0) scale(1.05); }
            100% { transform: translateX(0) scale(1); }
        }

        .toast.success {
            background: linear-gradient(45deg, var(--primary), var(--secondary));
        }

        .toast.error {
            background: linear-gradient(45deg, var(--danger), var(--accent));
        }

        /* Utility Classes */
        .hidden {
            display: none !important;
        }

        /* Mobile Responsiveness */
        @media (max-width: 768px) {
            .container {
                padding: 0 15px;
            }
            
            .header {
                flex-direction: column;
                gap: 1.5rem;
                text-align: center;
                padding: 2rem;
            }
            
            .logo-text {
                font-size: 1.8rem;
            }
            
            .input-section {
                padding: 2rem;
            }
            
            .responses-grid {
                grid-template-columns: 1fr;
                gap: 1.5rem;
            }
            
            .response-card {
                padding: 1.5rem;
            }
            
            .toast {
                top: 1rem;
                right: 1rem;
                left: 1rem;
            }

            .responses-title {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
    <div class="bg-elements">
        <div class="floating-orb orb-1"></div>
        <div class="floating-orb orb-2"></div>
        <div class="floating-orb orb-3"></div>
        <div class="floating-orb orb-4"></div>
        <div class="floating-orb orb-5"></div>
        <div class="geometric-shape triangle"></div>
        <div class="geometric-shape square"></div>
        <div class="geometric-shape diamond"></div>
    </div>

    <div class="container">
        <header class="header">
            <div class="logo">
                <div class="logo-icon">R</div>
                <div>
                    <h1 class="logo-text">RAGEBAITER</h1>
                    <div class="logo-subtitle">Master the Art of Response</div>
                </div>
            </div>
            <div class="auth-section">
                <button id="loginBtn" class="login-btn hidden">Connect to Generate</button>
                <div id="userInfo" class="user-info hidden">
                    <div class="status-dot"></div>
                    <span id="userName"></span>
                    <button id="logoutBtn" class="logout-btn">Disconnect</button>
                </div>
            </div>
        </header>

        <main class="main-content">
            <div class="input-section">
                <label for="contextInput" class="input-label">Enter the context or sentence:</label>
                <textarea 
                    id="contextInput" 
                    class="context-input" 
                    placeholder="Paste the message, comment, or statement you want to respond to..."
                    rows="4"
                ></textarea>
                <button id="generateBtn" class="generate-btn" disabled>
                    <span class="btn-text">Generate Responses</span>
                    <div class="btn-loader hidden"></div>
                </button>
            </div>

            <div class="responses-section">
                <div id="responseContainer" class="response-container hidden">
                    <h2 class="responses-title">Your Response Arsenal</h2>
                    <div class="responses-grid">
                        <div class="response-card" id="response1">
                            <div class="method-badge">
                                <span class="method-name"></span>
                            </div>
                            <div class="response-content"></div>
                            <button class="copy-btn" data-response="1">
                                📋 Copy Response
                            </button>
                        </div>
                        <div class="response-card" id="response2">
                            <div class="method-badge">
                                <span class="method-name"></span>
                            </div>
                            <div class="response-content"></div>
                            <button class="copy-btn" data-response="2">
                                📋 Copy Response
                            </button>
                        </div>
                        <div class="response-card" id="response3">
                            <div class="method-badge">
                                <span class="method-name"></span>
                            </div>
                            <div class="response-content"></div>
                            <button class="copy-btn" data-response="3">
                                📋 Copy Response
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <div id="toast" class="toast hidden"></div>

    <script>
        class RageBaiter {
            constructor() {
                this.puterClient = null;
                this.isAuthenticated = false;
                this.userName = '';
                
                this.initializeElements();
                this.attachEventListeners();
                this.checkAutoLogin();
            }

            initializeElements() {
                this.loginBtn = document.getElementById('loginBtn');
                this.logoutBtn = document.getElementById('logoutBtn');
                this.userInfo = document.getElementById('userInfo');
                this.userName = document.getElementById('userName');
                this.contextInput = document.getElementById('contextInput');
                this.generateBtn = document.getElementById('generateBtn');
                this.responseContainer = document.getElementById('responseContainer');
                this.toast = document.getElementById('toast');
                this.btnText = document.querySelector('.btn-text');
                this.btnLoader = document.querySelector('.btn-loader');
            }

            attachEventListeners() {
                this.loginBtn.addEventListener('click', () => this.handleLogin());
                this.logoutBtn.addEventListener('click', () => this.handleLogout());
                this.generateBtn.addEventListener('click', () => this.generateResponses());
                this.contextInput.addEventListener('input', () => this.toggleGenerateButton());
                
                document.addEventListener('click', (e) => {
                    if (e.target.closest('.copy-btn')) {
                        const responseNum = e.target.closest('.copy-btn').dataset.response;
                        this.copyResponse(responseNum);
                    }
                });
            }

            async checkAutoLogin() {
                try {
                    const savedAuth = localStorage.getItem('ragebaiter_auth');
                    if (savedAuth) {
                        const authData = JSON.parse(savedAuth);
                        
                        // Wait for puter to be available
                        if (typeof puter !== 'undefined') {
                            this.puterClient = puter;
                            
                            // Try to get current user without token for initial check
                            try {
                                const user = await puter.auth.getUser();
                                if (user) {
                                    this.isAuthenticated = true;
                                    this.updateUIForAuthentication(user.username);
                                    this.showToast('Auto-login successful!', 'success');
                                    return;
                                }
                            } catch (getUserError) {
                                console.log('No existing session, showing login button');
                            }
                        }
                    }
                    this.showLoginButton();
                } catch (error) {
                    console.error('Auto-login failed:', error);
                    this.showLoginButton();
                }
            }

            async handleLogin() {
                try {
                    this.loginBtn.disabled = true;
                    this.loginBtn.textContent = 'Connecting...';

                    // Check if Puter is available
                    if (typeof puter === 'undefined') {
                        throw new Error('Puter SDK not loaded');
                    }

                    // Use the correct Puter authentication method
                    const user = await puter.auth.signIn();
                    
                    if (user) {
                        this.isAuthenticated = true;
                        this.puterClient = puter;
                        
                        // Save basic auth info
                        localStorage.setItem('ragebaiter_auth', JSON.stringify({ 
                            authenticated: true,
                            username: user.username 
                        }));
                        
                        this.updateUIForAuthentication(user.username);
                        this.showToast('Connected successfully!', 'success');
                    } else {
                        throw new Error('No user returned from sign in');
                    }
                } catch (error) {
                    console.error('Login error:', error);
                    this.showToast('Connection failed. Using demo mode.', 'error');
                    
                    // Demo mode fallback with auto-fade
                    setTimeout(() => {
                        this.isAuthenticated = true;
                        this.updateUIForAuthentication('Demo User');
                        this.showToast('Demo mode activated!', 'success');
                    }, 5000);
                    
                    this.resetLoginButton();
                }
            }

            async handleLogout() {
                try {
                    if (this.puterClient && typeof this.puterClient.auth?.signOut === 'function') {
                        await this.puterClient.auth.signOut();
                    }
                    
                    localStorage.removeItem('ragebaiter_auth');
                    this.isAuthenticated = false;
                    this.puterClient = null;
                    this.showLoginButton();
                    this.showToast('Disconnected successfully!', 'success');
                } catch (error) {
                    console.error('Logout error:', error);
                    this.showToast('Logout completed.', 'success');
                    
                    // Force logout even if error
                    localStorage.removeItem('ragebaiter_auth');
                    this.isAuthenticated = false;
                    this.puterClient = null;
                    this.showLoginButton();
                }
            }

            updateUIForAuthentication(username) {
                this.loginBtn.classList.add('hidden');
                this.userInfo.classList.remove('hidden');
                this.userName.textContent = username;
                this.toggleGenerateButton();
            }

            showLoginButton() {
                this.loginBtn.classList.remove('hidden');
                this.userInfo.classList.add('hidden');
                this.resetLoginButton();
                this.toggleGenerateButton();
            }

            resetLoginButton() {
                this.loginBtn.disabled = false;
                this.loginBtn.textContent = 'Connect to Generate';
            }

            toggleGenerateButton() {
                const hasInput = this.contextInput.value.trim().length > 0;
                this.generateBtn.disabled = !this.isAuthenticated || !hasInput;
            }

            analyzeContext(context) {
                const lower = context.toLowerCase();
                const topics = {
                    personal: ['i ', 'my ', 'me ', 'myself', 'personal', 'family', 'relationship'],
                    opinion: ['think', 'believe', 'feel', 'opinion', 'view', 'perspective'],
                    achievement: ['accomplished', 'achieved', 'won', 'success', 'proud', 'earned'],
                    complaint: ['hate', 'annoying', 'stupid', 'wrong', 'bad', 'terrible', 'awful'],
                    advice: ['should', 'need to', 'must', 'have to', 'advice', 'recommend'],
                    question: ['?', 'how', 'what', 'why', 'when', 'where', 'who'],
                    emotional: ['sad', 'happy', 'angry', 'frustrated', 'excited', 'depressed'],
                    political: ['government', 'politician', 'vote', 'election', 'liberal', 'conservative'],
                    social: ['society', 'people', 'generation', 'culture', 'social'],
                    technical: ['technology', 'computer', 'app', 'software', 'coding', 'programming'],
                    lifestyle: ['diet', 'exercise', 'health', 'food', 'travel', 'hobby'],
                    work: ['job', 'work', 'boss', 'colleague', 'career', 'salary', 'office']
                };

                let contextType = 'general';
                let maxScore = 0;

                for (const [type, keywords] of Object.entries(topics)) {
                    const score = keywords.reduce((acc, keyword) => {
                        return acc + (lower.includes(keyword) ? 1 : 0);
                    }, 0);
                    
                    if (score > maxScore) {
                        maxScore = score;
                        contextType = type;
                    }
                }

                return { type: contextType, confidence: maxScore };
            }

            selectOptimalMethods(contextAnalysis) {
                const methodCategories = {
                    personal: [
                        "Personal attacks masked as observations",
                        "Gaslighting by questioning memory",
                        "Fake victimhood manipulation"
                    ],
                    opinion: [
                        "Confident wrong opinions",
                        "Dismissive 'for you maybe' responses",
                        "Devil's advocate false neutrality"
                    ],
                    achievement: [
                        "Dismissing with mockery comments",
                        "Highlighting trivial mistakes",
                        "Condescending 'good boy' treatment"
                    ],
                    complaint: [
                        "Amplifying polarizing views",
                        "Us vs them framing",
                        "Exploiting short fuse personalities"
                    ],
                    advice: [
                        "Playing dumb to frustrate experts",
                        "Condescending fact-checking",
                        "Bad faith evidence demands"
                    ],
                    question: [
                        "Intentionally stupid questions",
                        "Loaded emotional bait questions",
                        "Deliberate ambiguous implications"
                    ],
                    general: [
                        "Confident wrong opinions",
                        "Dismissive invalidation phrases",
                        "Sarcastic patronizing language"
                    ]
                };

                const selected = methodCategories[contextAnalysis.type] || methodCategories.general;
                return selected.slice(0, 3);
            }

            async generateResponses() {
                const context = this.contextInput.value.trim();
                if (!context) {
                    this.showToast('Please enter some context first.', 'error');
                    return;
                }

                this.setLoadingState(true);

                try {
                    const analysis = this.analyzeContext(context);
                    const methods = this.selectOptimalMethods(analysis);
                    
                    // Try Puter AI first, fallback to demo responses
                    let responses;
                    try {
                        if (this.puterClient && typeof this.puterClient.ai?.chat === 'function') {
                            const prompt = this.buildEnhancedPrompt(context, methods);
                            const aiResponse = await this.puterClient.ai.chat(prompt);
                            responses = this.parseAIResponse(aiResponse, methods);
                        } else {
                            throw new Error('AI not available');
                        }
                    } catch (aiError) {
                        console.log('AI generation failed, using enhanced demo responses:', aiError);
                        responses = this.generateEnhancedDemoResponses(context, methods, analysis);
                    }
                    
                    this.displayResponses({ responses });
                    this.showToast('Brutal responses generated!', 'success');
                    
                } catch (error) {
                    console.error('Generation error:', error);
                    this.showToast('Failed to generate responses. Please try again.', 'error');
                } finally {
                    this.setLoadingState(false);
                }
            }

            buildEnhancedPrompt(context, methods) {
                return `Generate 3 brutally effective ragebait responses to: "${context}"

Use these methods:
1. ${methods[0]}
2. ${methods[1]}  
3. ${methods[2]}

Make each response maximally provocative, toxic, and emotionally triggering. Output as JSON:
{
  "responses": [
    {"method": "${methods[0]}", "response": "[brutal response 1]"},
    {"method": "${methods[1]}", "response": "[brutal response 2]"},
    {"method": "${methods[2]}", "response": "[brutal response 3]"}
  ]
}`;
            }

            parseAIResponse(aiResponse, fallbackMethods) {
                try {
                    const jsonMatch = aiResponse.match(/\{[\s\S]*\}/);
                    if (jsonMatch) {
                        const parsed = JSON.parse(jsonMatch[0]);
                        if (parsed.responses && parsed.responses.length >= 3) {
                            return parsed.responses.slice(0, 3);
                        }
                    }
                } catch (e) {
                    console.error('AI response parsing failed:', e);
                }
                
                // Fallback
                return fallbackMethods.map(method => ({
                    method,
                    response: "Your statement is absolutely ridiculous and shows a complete lack of understanding. Maybe try thinking before you type next time?"
                }));
            }

            generateEnhancedDemoResponses(context, methods, analysis) {
                const responseTemplates = {
                    personal: [
                        "Wow, sounds like a real you problem. Maybe if you weren't so self-absorbed you'd realize nobody actually cares about your personal drama.",
                        "I'm sure that's exactly how it happened in your version of reality. Must be nice living in that fantasy world where you're always the victim.",
                        "That's hilarious coming from someone who clearly has zero self-awareness. Maybe work on yourself before sharing your 'wisdom' with the world."
                    ],
                    opinion: [
                        "That's absolutely wrong and anyone with half a brain can see it. Your 'opinion' is just ignorance wrapped in confidence.",
                        "For you maybe, but most people with actual intelligence would disagree. Try thinking before you type next time.",
                        "Playing devil's advocate here, but your take is so bad it's actually impressive. Like, how do you even function with opinions this terrible?"
                    ],
                    achievement: [
                        "Congratulations on doing the bare minimum that any functional adult should be able to do. Want a participation trophy?",
                        "You made a tiny typo in your comment, which pretty much invalidates everything you're trying to say. Details matter, sweetie.",
                        "Good boy! You managed to string together a coherent sentence. I'm so proud of you for trying your best!"
                    ],
                    complaint: [
                        "Here we go again with another whiny rant. It's always someone else's fault with people like you, isn't it?",
                        "Us normal people vs you complainers who never take responsibility. Which side do you think society supports?",
                        "You seem like the type of person who gets triggered by literally everything. Maybe the internet isn't for you?"
                    ],
                    advice: [
                        "I don't understand why you think anyone would want advice from someone who clearly has their life figured out so poorly?",
                        "Actually, let me fact-check that for you since you obviously didn't do your research. You're completely wrong about basically everything.",
                        "Citation needed. Citation needed. Citation needed. Prove literally every word you just said or admit you're making it all up."
                    ],
                    question: [
                        "Are you seriously asking something this stupid? Like, did you even think for one second before posting this?",
                        "What's your real agenda here? Because this 'innocent' question is obviously loaded and designed to start drama.",
                        "I can't tell if you're genuinely confused or just pretending to be this dense. Either way, it's not a good look."
                    ],
                    general: [
                        "This is so wrong it's actually painful to read. How do you go through life being this confidently incorrect about everything?",
                        "Sounds like a you problem, but thanks for sharing your irrelevant thoughts with the world. Really valuable contribution.",
                        "Oh honey, bless your heart for trying to have an opinion. Maybe stick to subjects you actually understand next time?"
                    ]
                };

                const contextTemplates = responseTemplates[analysis.type] || responseTemplates.general;
                
                return methods.map((method, index) => ({
                    method: method,
                    response: contextTemplates[index] || contextTemplates[0]
                }));
            }

            displayResponses(data) {
                if (!data.responses || data.responses.length < 3) {
                    throw new Error('Invalid response format');
                }

                this.responseContainer.classList.remove('hidden');

                data.responses.forEach((responseData, index) => {
                    const card = document.getElementById(`response${index + 1}`);
                    const methodBadge = card.querySelector('.method-name');
                    const responseContent = card.querySelector('.response-content');

                    methodBadge.textContent = responseData.method.substring(0, 35) + '...';
                    responseContent.textContent = responseData.response;
                });

                setTimeout(() => {
                    this.responseContainer.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }, 100);
            }

            async copyResponse(responseNum) {
                const card = document.getElementById(`response${responseNum}`);
                const responseText = card.querySelector('.response-content').textContent;
                const copyBtn = card.querySelector('.copy-btn');

                try {
                    await navigator.clipboard.writeText(responseText);
                    copyBtn.textContent = '✅ Copied!';
                    copyBtn.classList.add('copied');
                    
                    setTimeout(() => {
                        copyBtn.textContent = '📋 Copy Response';
                        copyBtn.classList.remove('copied');
                    }, 2000);
                    
                    this.showToast('Response copied to clipboard!', 'success');
                } catch (error) {
                    const textArea = document.createElement('textarea');
                    textArea.value = responseText;
                    document.body.appendChild(textArea);
                    textArea.select();
                    document.execCommand('copy');
                    document.body.removeChild(textArea);
                    this.showToast('Response copied!', 'success');
                }
            }

            setLoadingState(isLoading) {
                if (isLoading) {
                    this.generateBtn.disabled = true;
                    this.btnText.classList.add('hidden');
                    this.btnLoader.classList.remove('hidden');
                } else {
                    this.generateBtn.disabled = !this.isAuthenticated || !this.contextInput.value.trim();
                    this.btnText.classList.remove('hidden');
                    this.btnLoader.classList.add('hidden');
                }
            }

            showToast(message, type = 'info') {
                this.toast.textContent = message;
                this.toast.className = `toast ${type} show`;

                // Auto-fade after 5 seconds
                setTimeout(() => {
                    this.toast.classList.remove('show');
                }, 5000);
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            new RageBaiter();
        });
    </script>
</body>
</html>
