<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Master Baiter</title>
    <script src="https://js.puter.com/v2/"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #dc2626;
            --primary-dark: #b91c1c;
            --secondary: #64748b;
            --accent: #f59e0b;
            --bg: #0f172a;
            --bg-secondary: #1e293b;
            --card-bg: #1e293b;
            --text: #f8fafc;
            --text-secondary: #94a3b8;
            --border: #334155;
            --success: #10b981;
            --danger: #ef4444;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Inter', 'Segoe UI', system-ui, sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
            min-height: 100vh;
            font-size: 14px;
            position: relative;
        }

        .auth-section {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .login-btn, .logout-btn {
            padding: 12px 20px;
            border: 1px solid var(--primary);
            border-radius: 6px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 14px;
            background: var(--primary);
            color: white;
            margin: 0;
        }

        .login-btn:focus, .logout-btn:focus {
            outline: none !important;
            box-shadow: none !important;
        }

        .login-btn.hidden {
            display: none !important;
        }

        .login-btn:hover, .logout-btn:hover {
            opacity: 0.9;
        }

        .logout-btn {
            background: var(--danger);
            border-color: var(--danger);
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 12px;
            background: var(--card-bg);
            border-radius: 6px;
            border: 1px solid var(--border);
        }

        .status-dot {
            width: 6px;
            height: 6px;
            background: var(--primary);
            border-radius: 50%;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 60px 20px 40px;
        }

        /* Hero Section */
        .hero-section {
            text-align: center;
            padding: 80px 0 60px;
        }

        .hero-title {
            font-size: 4rem;
            font-weight: 900;
            margin-bottom: 20px;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-transform: uppercase;
            letter-spacing: -2px;
        }

        .hero-subtitle {
            font-size: 1.5rem;
            color: var(--text-secondary);
            margin-bottom: 50px;
            max-width: 700px;
            margin-left: auto;
            margin-right: auto;
        }

        /* Generate Section */
        .generate-section {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 40px;
            border: 1px solid var(--border);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            margin-bottom: 50px;
            text-align: center;
        }

        .generate-title {
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 20px;
            color: var(--text);
        }

        .generate-subtitle {
            color: var(--text-secondary);
            margin-bottom: 30px;
            font-size: 1.1rem;
        }

        .generate-btn {
            padding: 20px 40px;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 18px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 1px;
            position: relative;
            overflow: hidden;
        }

        .generate-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 35px rgba(220, 38, 38, 0.4);
        }

        .generate-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .btn-loader {
            width: 24px;
            height: 24px;
            border: 3px solid rgba(255,255,255,0.3);
            border-top: 3px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Results Section */
        .results-section {
            margin-top: 50px;
        }

        .results-title {
            text-align: center;
            font-size: 2.5rem;
            font-weight: 900;
            margin-bottom: 40px;
            color: var(--primary);
            text-transform: uppercase;
        }

        .results-grid {
            display: grid;
            gap: 20px;
            grid-template-columns: 1fr;
        }

        .result-card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 24px;
            border: 1px solid var(--border);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .result-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            border-color: var(--primary);
        }

        .roast-number {
            background: linear-gradient(135deg, var(--primary), var(--accent));
            color: white;
            padding: 6px 12px;
            border-radius: 20px;
            font-weight: 700;
            font-size: 12px;
            display: inline-block;
            margin-bottom: 16px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .roast-text {
            font-size: 18px;
            line-height: 1.6;
            margin-bottom: 20px;
            color: var(--text);
            background: var(--bg);
            padding: 24px;
            border-radius: 12px;
            border-left: 4px solid var(--primary);
            font-weight: 600;
        }

        .copy-btn {
            width: 100%;
            padding: 14px;
            background: var(--secondary);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s;
            font-size: 14px;
            text-transform: uppercase;
        }

        .copy-btn:hover {
            background: #475569;
            transform: translateY(-1px);
        }

        .copy-btn.copied {
            background: var(--success);
        }

        /* Toast */
        .toast {
            position: fixed;
            top: 80px;
            right: 20px;
            background: var(--card-bg);
            color: var(--text);
            padding: 16px 24px;
            border-radius: 12px;
            border: 1px solid var(--border);
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
            z-index: 1000;
            transform: translateX(100%);
            transition: transform 0.3s ease;
            font-weight: 500;
        }

        .toast.show {
            transform: translateX(0);
        }

        .toast.success {
            border-color: var(--success);
            background: rgba(16, 185, 129, 0.1);
        }

        .toast.error {
            border-color: var(--danger);
            background: rgba(239, 68, 68, 0.1);
        }

        /* Utility Classes */
        .hidden {
            display: none !important;
        }

        /* Mobile Responsiveness */
        @media (max-width: 768px) {
            .container {
                padding: 40px 16px 20px;
            }
            
            .auth-section {
                top: 16px;
                right: 16px;
            }
            
            .hero-title {
                font-size: 2.8rem;
            }
            
            .hero-subtitle {
                font-size: 1.2rem;
            }
            
            .generate-section {
                padding: 30px 20px;
            }
            
            .generate-btn {
                padding: 16px 30px;
                font-size: 16px;
            }
            
            .toast {
                top: 60px;
                right: 16px;
                left: 16px;
                transform: translateY(-100%);
            }
            
            .toast.show {
                transform: translateY(0);
            }
        }

        @media (max-width: 480px) {
            .hero-title {
                font-size: 2.2rem;
            }
            
            .hero-subtitle {
                font-size: 1.1rem;
            }
            
            .generate-section {
                padding: 24px 16px;
            }
        }
    </style>
</head>
<body>
    <div class="auth-section">
        <button id="loginBtn" class="login-btn hidden">Connect</button>
        <div id="userInfo" class="user-info hidden">
            <div class="status-dot"></div>
            <span id="userName"></span>
            <button id="logoutBtn" class="logout-btn">Logout</button>
        </div>
    </div>

    <div class="container">
        <section class="hero-section">
            <h1 class="hero-title">Ragebait 'em</h1>
        </section>

        <section class="generate-section">
            <h2 class="generate-title">Ragebait 'em</h2>
            <p class="generate-subtitle">Imagine being so unemployed you gotta use ts 🥀</p>
            
            <button id="generateBtn" class="generate-btn">
                <span class="btn-text">bait 'em all</span>
                <div class="btn-loader hidden"></div>
            </button>
        </section>

        <section class="results-section">
            <div id="resultsContainer" class="results-container hidden">
                <h2 class="results-title">Here you go gng</h2>
                <div class="results-grid" id="resultsGrid">
                    <!-- Results will be populated here -->
                </div>
            </div>
        </section>
    </div>

    <div id="toast" class="toast hidden"></div>

    <script>
        class MasterBaiter {
            constructor() {
                this.puterClient = null;
                this.isAuthenticated = false;
                this.userName = '';
                
                this.initializeElements();
                this.attachEventListeners();
                this.checkAutoLogin();
            }

            initializeElements() {
                this.loginBtn = document.getElementById('loginBtn');
                this.logoutBtn = document.getElementById('logoutBtn');
                this.userInfo = document.getElementById('userInfo');
                this.userName = document.getElementById('userName');
                this.generateBtn = document.getElementById('generateBtn');
                this.resultsContainer = document.getElementById('resultsContainer');
                this.resultsGrid = document.getElementById('resultsGrid');
                this.toast = document.getElementById('toast');
                this.btnText = document.querySelector('.btn-text');
                this.btnLoader = document.querySelector('.btn-loader');
            }

            attachEventListeners() {
                this.loginBtn.addEventListener('click', () => this.handleLogin());
                this.logoutBtn.addEventListener('click', () => this.handleLogout());
                this.generateBtn.addEventListener('click', () => this.generateRoasts());
                
                document.addEventListener('click', (e) => {
                    if (e.target.closest('.copy-btn')) {
                        const roastText = e.target.closest('.result-card').querySelector('.roast-text').textContent;
                        this.copyRoast(roastText, e.target);
                    }
                });
            }

            async checkAutoLogin() {
                try {
                    const savedAuth = localStorage.getItem('masterbaiter_auth');
                    if (savedAuth) {
                        const authData = JSON.parse(savedAuth);
                        
                        if (typeof puter !== 'undefined') {
                            this.puterClient = puter;
                            
                            try {
                                const user = await puter.auth.getUser();
                                if (user) {
                                    this.isAuthenticated = true;
                                    this.updateUIForAuthentication(user.username);
                                    return;
                                }
                            } catch (getUserError) {
                                console.log('No existing session');
                            }
                        }
                    }
                    
                    // Auto-activate for standalone use
                    this.isAuthenticated = true;
                    this.updateUIForAuthentication('User');
                } catch (error) {
                    console.error('Auto-login failed:', error);
                    this.isAuthenticated = true;
                    this.updateUIForAuthentication('User');
                }
            }

            async handleLogin() {
                try {
                    this.loginBtn.disabled = true;
                    this.loginBtn.textContent = 'Connecting...';

                    if (typeof puter === 'undefined') {
                        throw new Error('Connection service unavailable');
                    }

                    const user = await puter.auth.signIn();
                    
                    if (user) {
                        this.isAuthenticated = true;
                        this.puterClient = puter;
                        
                        localStorage.setItem('masterbaiter_auth', JSON.stringify({ 
                            authenticated: true,
                            username: user.username 
                        }));
                        
                        this.updateUIForAuthentication(user.username);
                        this.showToast('Connected successfully!', 'success');
                    } else {
                        throw new Error('No user returned');
                    }
                } catch (error) {
                    console.error('Login error:', error);
                    this.showToast('Connection failed. Using offline mode.', 'error');
                    
                    setTimeout(() => {
                        this.isAuthenticated = true;
                        this.updateUIForAuthentication('Anonymous');
                        this.showToast('Offline mode active!', 'success');
                    }, 3000);
                    
                    this.resetLoginButton();
                }
            }

            async handleLogout() {
                try {
                    if (this.puterClient && typeof this.puterClient.auth?.signOut === 'function') {
                        await this.puterClient.auth.signOut();
                    }
                    
                    localStorage.removeItem('masterbaiter_auth');
                    this.isAuthenticated = false;
                    this.puterClient = null;
                    this.showLoginButton();
                    this.showToast('Logged out!', 'success');
                } catch (error) {
                    console.error('Logout error:', error);
                    localStorage.removeItem('masterbaiter_auth');
                    this.isAuthenticated = false;
                    this.puterClient = null;
                    this.showLoginButton();
                    this.showToast('Logged out!', 'success');
                }
            }

            updateUIForAuthentication(username) {
                this.loginBtn.classList.add('hidden');
                this.userInfo.classList.remove('hidden');
                this.userName.textContent = username;
            }

            showLoginButton() {
                this.loginBtn.classList.remove('hidden');
                this.userInfo.classList.add('hidden');
                this.resetLoginButton();
            }

            resetLoginButton() {
                this.loginBtn.disabled = false;
                this.loginBtn.textContent = 'Connect';
            }

            // NEW: AI-powered roast generation with heavy Gen Z slang
            async generateRoasts() {
                this.setLoadingState(true);

                try {
                    let roasts = [];
                    
                    // Try AI generation first
                    if (this.puterClient && typeof this.puterClient.ai?.chat === 'function') {
                        try {
                            const prompt = `Generate 5 extremely toxic, brutal roasts using heavy Gen Z slang. Use words like: sybau, gng, tuff, asf, delulu, npc, no cap, ratio, sus, vibe check, periodt, bet, drip, CEO of, lowkey, highkey, stan, cancel, shook, yeet, fire, mid, L, W.

Make them absolutely brutal and offensive. Focus on themes like unemployment, being a loser, having no life, no social skills, being cringe, etc.

Format as JSON:
{
  "roasts": [
    "roast 1 text",
    "roast 2 text", 
    "roast 3 text",
    "roast 4 text",
    "roast 5 text"
  ]
}`;

                            const aiResponse = await this.puterClient.ai.chat(prompt);
                            console.log('AI Response:', aiResponse);
                            
                            // Try to parse JSON from response
                            let parsedResponse;
                            try {
                                const jsonMatch = aiResponse.match(/\{[\s\S]*"roasts"[\s\S]*\]/);
                                if (jsonMatch) {
                                    parsedResponse = JSON.parse(jsonMatch[0] + '}');
                                } else {
                                    parsedResponse = JSON.parse(aiResponse);
                                }
                                
                                if (parsedResponse.roasts && parsedResponse.roasts.length >= 5) {
                                    roasts = parsedResponse.roasts.slice(0, 5);
                                } else {
                                    throw new Error('Invalid AI response format');
                                }
                            } catch (parseError) {
                                console.error('Failed to parse AI response:', parseError);
                                throw parseError;
                            }
                            
                        } catch (aiError) {
                            console.error('AI generation failed:', aiError);
                            throw aiError;
                        }
                    } else {
                        throw new Error('AI service unavailable');
                    }
                    
                    // Fallback roasts with heavy slang if AI fails
                    if (roasts.length === 0) {
                        roasts = this.getFallbackRoasts();
                    }
                    
                    this.displayResults(roasts);
                    this.showToast('Fresh roasts generated gng!', 'success');
                    
                } catch (error) {
                    console.error('Generation error:', error);
                    // Use fallback roasts with slang
                    const fallbackRoasts = this.getFallbackRoasts();
                    this.displayResults(fallbackRoasts);
                    this.showToast('Generated offline roasts asf', 'success');
                } finally {
                    this.setLoadingState(false);
                }
            }

            getFallbackRoasts() {
                const slangyRoasts = [
                    "sybau but you're actually the biggest NPC in existence gng. Nobody rates you, tuff asf and that's no cap.",
                    "Get off the timeline and go touch grass fr. Unemployment hitting different huh? L + ratio'd + no cap.",
                    "How you still this delulu in 2025? Your whole existence is just mid. Pure NPC behavior lowkey.",
                    "You peak at being a clown every single day. 'Ate' and left zero crumbs—just murdered everyone else's IQ.",
                    "Bro, imagine being so jobless you think this is a flex. Gng, you ate (ass) but left only L's periodt.",
                    "Literally no rizz, just cringe energy and a dried-up ego. Go lose again, you absolute bum.",
                    "Big Yikes energy. You're proof not everyone deserves WiFi access. SYBAU and log off please.",
                    "Did you really cook this reply? 'Cause it's giving major brainrot vibes, no cap chief.",
                    "Go ratio yourself, you massive L generator. Even Skibidi Toilet has more plot than your sad life.",
                    "You run your mouth for free and still can't get anyone to listen. Embarrassing asf fr.",
                    "Main character syndrome with side character energy, ngl. That's not it bestie.",
                    "Nobody: absolutely nobody: you: chronic failure arc, every single year. Touch grass, NPC.",
                    "You're not the main character, you're just a footnote. Rizz in the negatives tuff.",
                    "The way you fell off completely? Fr fr, just log off permanently. Gng already knew this.",
                    "Bro, your whole personality is just 'L'. Try harder next respawn, this ain't it."
                ];
                
                // Return 5 random ones
                const shuffled = [...slangyRoasts].sort(() => Math.random() - 0.5);
                return shuffled.slice(0, 5);
            }

            displayResults(roasts) {
                this.resultsGrid.innerHTML = '';
                
                roasts.forEach((roast, index) => {
                    const card = document.createElement('div');
                    card.className = 'result-card';
                    card.style.animationDelay = `${index * 100}ms`;
                    
                    card.innerHTML = `
                        <div class="roast-number">Roast #${index + 1}</div>
                        <div class="roast-text">${roast}</div>
                        <button class="copy-btn">Copy Roast</button>
                    `;
                    
                    this.resultsGrid.appendChild(card);
                });

                this.resultsContainer.classList.remove('hidden');
                
                setTimeout(() => {
                    this.resultsContainer.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }, 200);
            }

            async copyRoast(text, button) {
                try {
                    await navigator.clipboard.writeText(text);
                    button.textContent = '✓ Copied!';
                    button.classList.add('copied');
                    
                    setTimeout(() => {
                        button.textContent = 'Copy Roast';
                        button.classList.remove('copied');
                    }, 2000);
                    
                    this.showToast('Copied to clipboard!', 'success');
                } catch (error) {
                    const textArea = document.createElement('textarea');
                    textArea.value = text;
                    document.body.appendChild(textArea);
                    textArea.select();
                    document.execCommand('copy');
                    document.body.removeChild(textArea);
                    this.showToast('Copied to clipboard!', 'success');
                }
            }

            setLoadingState(isLoading) {
                if (isLoading) {
                    this.generateBtn.disabled = true;
                    this.btnText.classList.add('hidden');
                    this.btnLoader.classList.remove('hidden');
                } else {
                    this.generateBtn.disabled = false;
                    this.btnText.classList.remove('hidden');
                    this.btnLoader.classList.add('hidden');
                }
            }

            showToast(message, type = 'info') {
                this.toast.textContent = message;
                this.toast.className = `toast ${type} show`;

                setTimeout(() => {
                    this.toast.classList.remove('show');
                }, 3000);
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            new MasterBaiter();
        });
    </script>
</body>
</html>
