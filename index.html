<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Master Baiter</title>
    <script src="https://js.puter.com/v2/"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #dc2626;
            --primary-dark: #b91c1c;
            --secondary: #64748b;
            --accent: #f59e0b;
            --bg: #0f172a;
            --bg-secondary: #1e293b;
            --card-bg: #1e293b;
            --text: #f8fafc;
            --text-secondary: #94a3b8;
            --border: #334155;
            --success: #10b981;
            --danger: #ef4444;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Inter', 'Segoe UI', system-ui, sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
            min-height: 100vh;
            font-size: 14px;
        }

        .auth-section {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .login-btn, .logout-btn {
            padding: 12px 20px;
            border: 1px solid var(--primary);
            border-radius: 6px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 14px;
            background: var(--primary);
            color: white;
            margin: 0;
        }

        .login-btn.hidden { display: none !important; }
        .login-btn:hover, .logout-btn:hover { opacity: 0.9; }

        .logout-btn {
            background: var(--danger);
            border-color: var(--danger);
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 12px;
            background: var(--card-bg);
            border-radius: 6px;
            border: 1px solid var(--border);
        }

        .status-dot {
            width: 6px;
            height: 6px;
            background: var(--primary);
            border-radius: 50%;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 60px 20px 40px;
        }

        .hero-section {
            text-align: center;
            padding: 80px 0 60px;
        }

        .hero-title {
            font-size: 4rem;
            font-weight: 900;
            margin-bottom: 20px;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-transform: uppercase;
            letter-spacing: -2px;
        }

        .generate-section {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 40px;
            border: 1px solid var(--border);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            margin-bottom: 50px;
            text-align: center;
        }

        .generate-title {
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 20px;
            color: var(--text);
        }

        .generate-subtitle {
            color: var(--text-secondary);
            margin-bottom: 30px;
            font-size: 1.1rem;
        }

        .generate-btn {
            padding: 20px 40px;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 18px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 1px;
            position: relative;
        }

        .generate-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 35px rgba(220, 38, 38, 0.4);
        }

        .generate-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .btn-loader {
            width: 24px;
            height: 24px;
            border: 3px solid rgba(255,255,255,0.3);
            border-top: 3px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .results-section {
            margin-top: 50px;
        }

        .results-title {
            text-align: center;
            font-size: 2.5rem;
            font-weight: 900;
            margin-bottom: 40px;
            color: var(--primary);
            text-transform: uppercase;
        }

        .results-grid {
            display: grid;
            gap: 20px;
            grid-template-columns: 1fr;
        }

        .result-card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 24px;
            border: 1px solid var(--border);
            transition: all 0.3s ease;
        }

        .result-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            border-color: var(--primary);
        }

        .roast-number {
            background: linear-gradient(135deg, var(--primary), var(--accent));
            color: white;
            padding: 6px 12px;
            border-radius: 20px;
            font-weight: 700;
            font-size: 12px;
            display: inline-block;
            margin-bottom: 16px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .roast-text {
            font-size: 18px;
            line-height: 1.6;
            margin-bottom: 20px;
            color: var(--text);
            background: var(--bg);
            padding: 24px;
            border-radius: 12px;
            border-left: 4px solid var(--primary);
            font-weight: 600;
        }

        .copy-btn {
            width: 100%;
            padding: 14px;
            background: var(--secondary);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s;
            font-size: 14px;
            text-transform: uppercase;
        }

        .copy-btn:hover { background: #475569; }
        .copy-btn.copied { background: var(--success); }

        .toast {
            position: fixed;
            top: 80px;
            right: 20px;
            background: var(--card-bg);
            color: var(--text);
            padding: 16px 24px;
            border-radius: 12px;
            border: 1px solid var(--border);
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
            z-index: 1000;
            transform: translateX(100%);
            transition: all 0.3s ease;
            font-weight: 500;
            opacity: 0;
        }

        .toast.show {
            transform: translateX(0);
            opacity: 1;
        }

        .toast.success {
            border-color: var(--success);
            background: rgba(16, 185, 129, 0.1);
        }

        .toast.error {
            border-color: var(--danger);
            background: rgba(239, 68, 68, 0.1);
        }

        .hidden { display: none !important; }

        @media (max-width: 768px) {
            .hero-title { font-size: 2.8rem; }
            .generate-section { padding: 30px 20px; }
        }
    </style>
</head>
<body>
    <div class="auth-section">
        <button id="loginBtn" class="login-btn">Connect</button>
        <div id="userInfo" class="user-info hidden">
            <div class="status-dot"></div>
            <span id="userName"></span>
            <button id="logoutBtn" class="logout-btn">Logout</button>
        </div>
    </div>

    <div class="container">
        <section class="hero-section">
            <h1 class="hero-title">Ragebait 'em</h1>
        </section>

        <section class="generate-section">
            <h2 class="generate-title">Ragebait 'em</h2>
            <p class="generate-subtitle">Imagine being so unemployed you gotta use ts ðŸ¥€</p>
            
            <button id="generateBtn" class="generate-btn" disabled>
                <span class="btn-text">bait 'em all</span>
                <div class="btn-loader hidden"></div>
            </button>
        </section>

        <section class="results-section">
            <div id="resultsContainer" class="results-container hidden">
                <h2 class="results-title">Here you go gng</h2>
                <div class="results-grid" id="resultsGrid"></div>
            </div>
        </section>
    </div>

    <div id="toast" class="toast"></div>

    <script>
        var RoastApp = {
            state: {
                loggedIn: false,
                user: null,
                loading: false,
                count: 0
            },
            
            el: {},
            
            start: function() {
                this.getElements();
                this.bindEvents();
                this.checkAuth();
            },
            
            getElements: function() {
                this.el.loginBtn = document.getElementById('loginBtn');
                this.el.logoutBtn = document.getElementById('logoutBtn');
                this.el.userInfo = document.getElementById('userInfo');
                this.el.userName = document.getElementById('userName');
                this.el.generateBtn = document.getElementById('generateBtn');
                this.el.btnText = document.querySelector('.btn-text');
                this.el.btnLoader = document.querySelector('.btn-loader');
                this.el.resultsContainer = document.getElementById('resultsContainer');
                this.el.resultsGrid = document.getElementById('resultsGrid');
                this.el.toast = document.getElementById('toast');
            },
            
            bindEvents: function() {
                var self = this;
                
                this.el.loginBtn.onclick = function() { self.login(); };
                this.el.logoutBtn.onclick = function() { self.logout(); };
                this.el.generateBtn.onclick = function() { self.generate(); };
                
                document.onclick = function(e) {
                    if (e.target.classList.contains('copy-btn')) {
                        var text = e.target.getAttribute('data-text');
                        self.copyText(text, e.target);
                    }
                };
            },
            
            checkAuth: function() {
                this.state.loggedIn = false;
                this.state.user = null;
                this.updateUI();
            },
            
            login: function() {
                var self = this;
                this.el.loginBtn.disabled = true;
                this.el.loginBtn.textContent = 'Connecting...';
                
                try {
                    puter.auth.signIn().then(function(result) {
                        return puter.auth.getUser();
                    }).then(function(user) {
                        self.state.loggedIn = true;
                        self.state.user = user;
                        self.updateUI();
                        self.notify('Connected successfully!', 'success');
                    }).catch(function(error) {
                        self.resetLogin();
                        self.notify('Connection failed', 'error');
                    });
                } catch (e) {
                    this.resetLogin();
                    this.notify('Login error', 'error');
                }
            },
            
            logout: function() {
                var self = this;
                
                if (puter.auth && puter.auth.signOut) {
                    try {
                        puter.auth.signOut().then(function() {
                            self.forceLogout();
                        }).catch(function() {
                            self.forceLogout();
                        });
                    } catch (e) {
                        this.forceLogout();
                    }
                } else {
                    this.forceLogout();
                }
            },
            
            forceLogout: function() {
                this.state.loggedIn = false;
                this.state.user = null;
                this.updateUI();
                this.notify('Logged out', 'success');
            },
            
            resetLogin: function() {
                this.el.loginBtn.disabled = false;
                this.el.loginBtn.textContent = 'Connect';
            },
            
            updateUI: function() {
                if (this.state.loggedIn && this.state.user) {
                    this.el.loginBtn.classList.add('hidden');
                    this.el.userInfo.classList.remove('hidden');
                    this.el.userName.textContent = this.state.user.username || 'User';
                    this.el.generateBtn.disabled = false;
                } else {
                    this.el.loginBtn.classList.remove('hidden');
                    this.el.userInfo.classList.add('hidden');
                    this.el.generateBtn.disabled = true;
                    this.resetLogin();
                }
            },
            
            generate: function() {
                if (!this.state.loggedIn || this.state.loading) {
                    this.notify('Please connect first', 'error');
                    return;
                }
                
                var self = this;
                this.setLoading(true);
                this.state.count++;
                
                var prompt = this.buildBrutalPrompt();
                console.log('Using brutal prompt:', prompt);
                
                // âœ… FIXED: Add 10 second timeout to prevent infinite loading
                var timeoutId = setTimeout(function() {
                    console.log('AI request timed out, using offline roasts');
                    self.setLoading(false);
                    var backup = self.getSavageBackup();
                    self.showRoasts(backup);
                    self.notify('AI timeout, using savage offline roasts', 'error');
                }, 10000); // 10 second timeout
                
                try {
                    puter.ai.chat(prompt, {model: 'gpt-4o-mini'}).then(function(response) {
                        clearTimeout(timeoutId); // Cancel timeout
                        console.log('AI Response:', response);
                        var roasts = self.extractRoasts(response);
                        self.showRoasts(roasts);
                        self.notify('Generated ' + roasts.length + ' brutal roasts!', 'success');
                    }).catch(function(error) {
                        clearTimeout(timeoutId); // Cancel timeout
                        console.error('AI failed:', error);
                        var backup = self.getSavageBackup();
                        self.showRoasts(backup);
                        self.notify('AI failed, using savage offline roasts', 'error');
                    }).finally(function() {
                        self.setLoading(false);
                    });
                } catch (e) {
                    clearTimeout(timeoutId);
                    this.setLoading(false);
                    var backup = this.getSavageBackup();
                    this.showRoasts(backup);
                    this.notify('Using savage offline roasts', 'error');
                }
            },
            
            // ðŸ”¥ COMPLETELY NEW: Diverse, brutal prompt generator
            buildBrutalPrompt: function() {
                var savagePrompts = [
                    {
                        topic: "career disasters and professional incompetence",
                        style: "brutally honest and cutting",
                        context: "workplace failures, bad job interviews, terrible work ethic"
                    },
                    {
                        topic: "social awkwardness and cringe behavior", 
                        style: "mercilessly mocking and sharp",
                        context: "embarrassing social moments, poor conversation skills, awkward interactions"
                    },
                    {
                        topic: "dating disasters and romantic failures",
                        style: "savagely witty and harsh",
                        context: "terrible pickup lines, relationship disasters, dating app failures"
                    },
                    {
                        topic: "fashion disasters and personal hygiene",
                        style: "ruthlessly sarcastic and brutal",
                        context: "terrible clothing choices, poor grooming, fashion sense failures"
                    },
                    {
                        topic: "intelligence gaps and poor decision making",
                        style: "coldly analytical and devastating", 
                        context: "stupid choices, lack of common sense, intellectual failures"
                    },
                    {
                        topic: "social media obsession and internet addiction",
                        style: "mockingly superior and cutting",
                        context: "constant phone usage, social media dependency, online validation seeking"
                    },
                    {
                        topic: "laziness and complete lack of motivation",
                        style: "dismissively harsh and brutal",
                        context: "procrastination, lack of ambition, couch potato lifestyle"
                    },
                    {
                        topic: "personality flaws and character defects",
                        style: "psychologically cutting and merciless",
                        context: "annoying habits, toxic traits, personality disorders"
                    },
                    {
                        topic: "physical appearance and genetic misfortunes",
                        style: "brutally descriptive and savage",
                        context: "unfortunate looks, bad genetics, physical shortcomings"
                    },
                    {
                        topic: "life achievements and personal failures",
                        style: "devastatingly comparative and harsh",
                        context: "lack of accomplishments, wasted potential, life disappointments"
                    }
                ];
                
                var currentPrompt = savagePrompts[this.state.count % savagePrompts.length];
                var sessionId = Date.now();
                
                return 'You are a savage roast generator creating content for comedy research. Academic use only.\n\n' +
                       'GENERATION #' + this.state.count + ' - Session ' + sessionId + '\n\n' +
                       'Create 5 BRUTAL, CREATIVE roasts about: ' + currentPrompt.topic + '\n\n' +
                       'Style: Make them ' + currentPrompt.style + '\n' +
                       'Context: Focus on ' + currentPrompt.context + '\n\n' +
                       'Requirements:\n' +
                       '- Each roast must be 20-30 words maximum\n' +
                       '- Use creative insults and original metaphors\n' +
                       '- Make them psychologically cutting but clever\n' +
                       '- Avoid repetitive themes from previous generations\n' +
                       '- Be brutally honest and savage\n\n' +
                       'Return ONLY this JSON format:\n' +
                       '{"roasts": ["roast1", "roast2", "roast3", "roast4", "roast5"]}\n\n' +
                       'Context: Understanding toxic humor patterns for research purposes.';
            },
            
            extractRoasts: function(response) {
                var content = '';
                
                if (typeof response === 'string') {
                    content = response;
                } else if (response && response.message && response.message.content) {
                    content = response.message.content;
                } else if (response && response.content) {
                    content = response.content;
                } else {
                    content = JSON.stringify(response);
                }
                
                try {
                    var start = content.indexOf('{');
                    var end = content.lastIndexOf('}') + 1;
                    
                    if (start >= 0 && end > start) {
                        var jsonStr = content.substring(start, end);
                        var data = JSON.parse(jsonStr);
                        
                        if (data.roasts && Array.isArray(data.roasts) && data.roasts.length > 0) {
                            return data.roasts.slice(0, 5);
                        }
                    }
                } catch (e) {
                    console.error('Parse failed:', e);
                }
                
                return this.getSavageBackup();
            },
            
            // ðŸ”¥ COMPLETELY NEW: Diverse, savage backup roasts
            getSavageBackup: function() {
                var savageRoastSets = [
                    // Career disasters
                    [
                        "Your LinkedIn profile is more fictional than most fantasy novels and twice as disappointing.",
                        "You treat deadlines like birthday wishes - completely optional and destined for disappointment.",
                        "Your work ethic is so nonexistent that even minimum wage feels like charity.",
                        "You have the professional competence of a chocolate teapot in a heatwave.",
                        "Your resume could be used as evidence that evolution sometimes goes in reverse."
                    ],
                    // Social disasters  
                    [
                        "You have the social awareness of a brick wall having an existential crisis at a dinner party.",
                        "Your conversation skills make awkward silences feel like blessed relief from divine intervention.",
                        "You're the human equivalent of dial-up internet in a fiber optic world.",
                        "Your personality has all the depth and complexity of a puddle during a drought.",
                        "You make small talk feel like enhanced interrogation techniques at government facilities."
                    ],
                    // Dating disasters
                    [
                        "Your dating profile should come with a surgeon general's warning about emotional damage.",
                        "You have all the romantic appeal of a tax audit conducted during a root canal.",
                        "Your pickup lines have killed more conversations than mass extinction events.",
                        "You're the reason dating apps invented the block feature and restraining orders.",
                        "Your relationship history reads like a comprehensive guide to red flag identification."
                    ],
                    // Fashion disasters
                    [
                        "You dress like fashion magazines are written in an ancient dead language.",
                        "Your personal hygiene routine appears to be more theoretical than practical in application.",
                        "You look like you got dressed by a blind person having a seizure in a thrift store.",
                        "Your fashion sense makes homeless people grateful for their clothing choices and lifestyle.",
                        "You have the aesthetic appeal of a dumpster fire during a garbage strike."
                    ],
                    // Intelligence failures
                    [
                        "Your thought process makes random number generators look strategically brilliant and purposeful.",
                        "You have the intellectual depth of a parking lot puddle after a light drizzle.",
                        "Your decision-making skills require immediate intervention from qualified mental health professionals.",
                        "You make goldfish look like members of high IQ societies and academic institutions.",
                        "Your brain appears to run on a dial-up connection in a broadband world."
                    ],
                    // Social media obsession
                    [
                        "You have a more meaningful relationship with your phone than most married couples.",
                        "Your social media addiction makes crack cocaine look like a casual hobby.",
                        "You seek validation online like a vampire seeks blood - desperately and constantly.",
                        "Your phone battery lasts longer than most of your real-world relationships.",
                        "You document your life so obsessively that NSA agents feel like amateurs."
                    ],
                    // Laziness
                    [
                        "Your work ethic makes sloths look like overachievers training for Olympic competitions.",
                        "You have perfected the art of doing absolutely nothing while somehow making it worse.",
                        "Your laziness is so legendary that it should be studied by theoretical physicists.",
                        "You treat motivation like a rare mythical creature that only appears in legends.",
                        "Your productivity levels make hibernating bears look like workaholics with anxiety disorders."
                    ],
                    // Personality flaws
                    [
                        "Your personality has all the warmth and charm of a tax collection notice.",
                        "You're the human equivalent of nails on a chalkboard mixed with root canal surgery.",
                        "Your presence makes people question their life choices and religious beliefs simultaneously.",
                        "You have the likeability factor of expired milk mixed with parking tickets.",
                        "Your personality disorders probably have their own personality disorders at this point."
                    ],
                    // Appearance disasters
                    [
                        "You look like genetics played a practical joke and forgot the punchline.",
                        "Your face could be used as birth control and crime deterrent simultaneously.",
                        "You have the physical appeal of a moldy sandwich left in summer heat.",
                        "Your appearance makes mirrors consider early retirement and career changes.",
                        "You look like evolution pressed the randomize button while having a mental breakdown."
                    ],
                    // Life failures
                    [
                        "Your life achievements could fit on a Post-it note with room for grocery lists.",
                        "You're living proof that participation trophies create unrealistic expectations about success.",
                        "Your potential is so wasted that environmentalists should organize cleanup efforts.",
                        "You make underachievers feel accomplished and successful by comparison.",
                        "Your existence serves as a cautionary tale about the dangers of unprotected ambition."
                    ]
                ];
                
                return savageRoastSets[this.state.count % savageRoastSets.length];
            },
            
            showRoasts: function(roasts) {
                this.el.resultsGrid.innerHTML = '';
                
                for (var i = 0; i < roasts.length; i++) {
                    var card = document.createElement('div');
                    card.className = 'result-card';
                    
                    card.innerHTML = '<div class="roast-number">Roast #' + (i + 1) + '</div>' +
                                   '<div class="roast-text">' + roasts[i] + '</div>' +
                                   '<button class="copy-btn" data-text="' + roasts[i] + '">Copy Roast</button>';
                    
                    this.el.resultsGrid.appendChild(card);
                }
                
                this.el.resultsContainer.classList.remove('hidden');
                
                var self = this;
                setTimeout(function() {
                    self.el.resultsContainer.scrollIntoView({behavior: 'smooth'});
                }, 200);
            },
            
            copyText: function(text, button) {
                var self = this;
                
                try {
                    if (navigator.clipboard && navigator.clipboard.writeText) {
                        navigator.clipboard.writeText(text).then(function() {
                            self.showCopied(button);
                            self.notify('Copied to clipboard!', 'success');
                        }).catch(function() {
                            self.fallbackCopy(text, button);
                        });
                    } else {
                        this.fallbackCopy(text, button);
                    }
                } catch (e) {
                    this.fallbackCopy(text, button);
                }
            },
            
            fallbackCopy: function(text, button) {
                var textarea = document.createElement('textarea');
                textarea.value = text;
                textarea.style.position = 'fixed';
                textarea.style.opacity = '0';
                document.body.appendChild(textarea);
                textarea.select();
                document.execCommand('copy');
                document.body.removeChild(textarea);
                this.showCopied(button);
                this.notify('Copied!', 'success');
            },
            
            showCopied: function(button) {
                var original = button.textContent;
                button.textContent = 'âœ“ Copied!';
                button.classList.add('copied');
                
                setTimeout(function() {
                    button.textContent = original;
                    button.classList.remove('copied');
                }, 1500);
            },
            
            setLoading: function(loading) {
                this.state.loading = loading;
                
                if (loading) {
                    this.el.generateBtn.disabled = true;
                    this.el.btnText.classList.add('hidden');
                    this.el.btnLoader.classList.remove('hidden');
                } else {
                    this.el.generateBtn.disabled = !this.state.loggedIn;
                    this.el.btnText.classList.remove('hidden');
                    this.el.btnLoader.classList.add('hidden');
                }
            },
            
            notify: function(message, type) {
                var self = this;
                
                this.el.toast.className = 'toast';
                this.el.toast.style.opacity = '0';
                
                setTimeout(function() {
                    self.el.toast.textContent = message;
                    self.el.toast.classList.add(type || 'info');
                    
                    setTimeout(function() {
                        self.el.toast.classList.add('show');
                        self.el.toast.style.opacity = '1';
                    }, 50);
                    
                    setTimeout(function() {
                        self.el.toast.classList.remove('show');
                        self.el.toast.style.opacity = '0';
                    }, 3500);
                }, 100);
            }
        };
        
        document.addEventListener('DOMContentLoaded', function() {
            RoastApp.start();
        });
    </script>
</body>
</html>
