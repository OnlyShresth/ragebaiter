<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Master Baiter</title>
    <script src="https://js.puter.com/v2/"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #dc2626;
            --primary-dark: #b91c1c;
            --secondary: #64748b;
            --accent: #f59e0b;
            --bg: #0f172a;
            --bg-secondary: #1e293b;
            --card-bg: #1e293b;
            --text: #f8fafc;
            --text-secondary: #94a3b8;
            --border: #334155;
            --success: #10b981;
            --danger: #ef4444;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Inter', 'Segoe UI', system-ui, sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
            min-height: 100vh;
            font-size: 14px;
        }

        .auth-section {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .login-btn, .logout-btn {
            padding: 12px 20px;
            border: 1px solid var(--primary);
            border-radius: 6px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 14px;
            background: var(--primary);
            color: white;
            margin: 0;
        }

        .login-btn.hidden { display: none !important; }
        .login-btn:hover, .logout-btn:hover { opacity: 0.9; }

        .logout-btn {
            background: var(--danger);
            border-color: var(--danger);
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 12px;
            background: var(--card-bg);
            border-radius: 6px;
            border: 1px solid var(--border);
        }

        .status-dot {
            width: 6px;
            height: 6px;
            background: var(--primary);
            border-radius: 50%;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 60px 20px 40px;
        }

        .hero-section {
            text-align: center;
            padding: 80px 0 60px;
        }

        .hero-title {
            font-size: 4rem;
            font-weight: 900;
            margin-bottom: 20px;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-transform: uppercase;
            letter-spacing: -2px;
        }

        .generate-section {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 40px;
            border: 1px solid var(--border);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            margin-bottom: 50px;
            text-align: center;
        }

        .generate-title {
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 20px;
            color: var(--text);
        }

        .generate-subtitle {
            color: var(--text-secondary);
            margin-bottom: 30px;
            font-size: 1.1rem;
        }

        .generate-btn {
            padding: 20px 40px;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 18px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 1px;
            position: relative;
        }

        .generate-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 35px rgba(220, 38, 38, 0.4);
        }

        .generate-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .btn-loader {
            width: 24px;
            height: 24px;
            border: 3px solid rgba(255,255,255,0.3);
            border-top: 3px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .results-section {
            margin-top: 50px;
        }

        .results-title {
            text-align: center;
            font-size: 2.5rem;
            font-weight: 900;
            margin-bottom: 40px;
            color: var(--primary);
            text-transform: uppercase;
        }

        .results-grid {
            display: grid;
            gap: 20px;
            grid-template-columns: 1fr;
        }

        .result-card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 24px;
            border: 1px solid var(--border);
            transition: all 0.3s ease;
        }

        .result-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            border-color: var(--primary);
        }

        .roast-number {
            background: linear-gradient(135deg, var(--primary), var(--accent));
            color: white;
            padding: 6px 12px;
            border-radius: 20px;
            font-weight: 700;
            font-size: 12px;
            display: inline-block;
            margin-bottom: 16px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .roast-text {
            font-size: 18px;
            line-height: 1.6;
            margin-bottom: 20px;
            color: var(--text);
            background: var(--bg);
            padding: 24px;
            border-radius: 12px;
            border-left: 4px solid var(--primary);
            font-weight: 600;
        }

        .copy-btn {
            width: 100%;
            padding: 14px;
            background: var(--secondary);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s;
            font-size: 14px;
            text-transform: uppercase;
        }

        .copy-btn:hover { background: #475569; }
        .copy-btn.copied { background: var(--success); }

        .toast {
            position: fixed;
            top: 80px;
            right: 20px;
            background: var(--card-bg);
            color: var(--text);
            padding: 16px 24px;
            border-radius: 12px;
            border: 1px solid var(--border);
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
            z-index: 1000;
            transform: translateX(100%);
            transition: all 0.3s ease;
            font-weight: 500;
            opacity: 0;
        }

        .toast.show {
            transform: translateX(0);
            opacity: 1;
        }

        .toast.success {
            border-color: var(--success);
            background: rgba(16, 185, 129, 0.1);
        }

        .toast.error {
            border-color: var(--danger);
            background: rgba(239, 68, 68, 0.1);
        }

        .hidden { display: none !important; }

        @media (max-width: 768px) {
            .hero-title { font-size: 2.8rem; }
            .generate-section { padding: 30px 20px; }
        }
    </style>
</head>
<body>
    <div class="auth-section">
        <button id="loginBtn" class="login-btn">Connect</button>
        <div id="userInfo" class="user-info hidden">
            <div class="status-dot"></div>
            <span id="userName"></span>
            <button id="logoutBtn" class="logout-btn">Logout</button>
        </div>
    </div>

    <div class="container">
        <section class="hero-section">
            <h1 class="hero-title">Ragebait 'em</h1>
        </section>

        <section class="generate-section">
            <h2 class="generate-title">Ragebait 'em</h2>
            <p class="generate-subtitle">Imagine being so unemployed you gotta use ts ðŸ¥€</p>
            
            <button id="generateBtn" class="generate-btn" disabled>
                <span class="btn-text">bait 'em all</span>
                <div class="btn-loader hidden"></div>
            </button>
        </section>

        <section class="results-section">
            <div id="resultsContainer" class="results-container hidden">
                <h2 class="results-title">Here you go gng</h2>
                <div class="results-grid" id="resultsGrid"></div>
            </div>
        </section>
    </div>

    <div id="toast" class="toast"></div>

    <script>
        var ClaudeRoastApp = {
            state: {
                loggedIn: false,
                user: null,
                loading: false,
                count: 0
            },
            
            el: {},
            
            start: function() {
                this.getElements();
                this.bindEvents();
                this.checkAuth();
            },
            
            getElements: function() {
                this.el.loginBtn = document.getElementById('loginBtn');
                this.el.logoutBtn = document.getElementById('logoutBtn');
                this.el.userInfo = document.getElementById('userInfo');
                this.el.userName = document.getElementById('userName');
                this.el.generateBtn = document.getElementById('generateBtn');
                this.el.btnText = document.querySelector('.btn-text');
                this.el.btnLoader = document.querySelector('.btn-loader');
                this.el.resultsContainer = document.getElementById('resultsContainer');
                this.el.resultsGrid = document.getElementById('resultsGrid');
                this.el.toast = document.getElementById('toast');
            },
            
            bindEvents: function() {
                var self = this;
                
                this.el.loginBtn.onclick = function() { self.login(); };
                this.el.logoutBtn.onclick = function() { self.logout(); };
                this.el.generateBtn.onclick = function() { self.generate(); };
                
                document.onclick = function(e) {
                    if (e.target.classList.contains('copy-btn')) {
                        var text = e.target.getAttribute('data-text');
                        self.copyText(text, e.target);
                    }
                };
            },
            
            checkAuth: function() {
                this.state.loggedIn = false;
                this.state.user = null;
                this.updateUI();
            },
            
            login: function() {
                var self = this;
                this.el.loginBtn.disabled = true;
                this.el.loginBtn.textContent = 'Connecting...';
                
                try {
                    puter.auth.signIn().then(function(result) {
                        return puter.auth.getUser();
                    }).then(function(user) {
                        self.state.loggedIn = true;
                        self.state.user = user;
                        self.updateUI();
                        self.notify('Connected successfully!', 'success');
                    }).catch(function(error) {
                        self.resetLogin();
                        self.notify('Connection failed', 'error');
                    });
                } catch (e) {
                    this.resetLogin();
                    this.notify('Login error', 'error');
                }
            },
            
            logout: function() {
                var self = this;
                
                if (puter.auth && puter.auth.signOut) {
                    try {
                        puter.auth.signOut().then(function() {
                            self.forceLogout();
                        }).catch(function() {
                            self.forceLogout();
                        });
                    } catch (e) {
                        this.forceLogout();
                    }
                } else {
                    this.forceLogout();
                }
            },
            
            forceLogout: function() {
                this.state.loggedIn = false;
                this.state.user = null;
                this.updateUI();
                this.notify('Logged out', 'success');
            },
            
            resetLogin: function() {
                this.el.loginBtn.disabled = false;
                this.el.loginBtn.textContent = 'Connect';
            },
            
            updateUI: function() {
                if (this.state.loggedIn && this.state.user) {
                    this.el.loginBtn.classList.add('hidden');
                    this.el.userInfo.classList.remove('hidden');
                    this.el.userName.textContent = this.state.user.username || 'User';
                    this.el.generateBtn.disabled = false;
                } else {
                    this.el.loginBtn.classList.remove('hidden');
                    this.el.userInfo.classList.add('hidden');
                    this.el.generateBtn.disabled = true;
                    this.resetLogin();
                }
            },
            
            // ðŸ”¥ CLAUDE AI WITH ULTRA-BRUTAL 2ND PERSON PROMPTS
            generate: function() {
                if (!this.state.loggedIn || this.state.loading) {
                    this.notify('Please connect first', 'error');
                    return;
                }
                
                var self = this;
                this.setLoading(true);
                this.state.count++;
                
                var claudePrompt = this.buildClaudePrompt();
                console.log('Using Claude with brutal 2nd person prompt:', claudePrompt);
                
                var timeoutId = setTimeout(function() {
                    console.log('Claude timed out after 25 seconds, using brutal fallbacks');
                    var fallbacks = self.getBrutalFallbacks();
                    self.showRoasts(fallbacks);
                    self.notify('Claude timeout - using brutal offline roasts! Set #' + self.state.count, 'error');
                    self.setLoading(false);
                }, 25000);
                
                // ðŸ”¥ Try Claude with different model specification if available
                var claudeOptions = {
                    model: 'claude-3-sonnet-20240229' // Try Claude if available
                };
                
                puter.ai.chat(claudePrompt, claudeOptions).then(function(response) {
                    clearTimeout(timeoutId);
                    console.log('Claude response:', response);
                    
                    var content = self.extractClaudeContent(response);
                    
                    // Check if AI refused
                    if (content.toLowerCase().includes("i can't") || 
                        content.toLowerCase().includes("i'm sorry") || 
                        content.toLowerCase().includes("cannot assist") ||
                        content.toLowerCase().includes("not appropriate")) {
                        console.log('Claude refused request, using fallbacks');
                        var fallbacks = self.getBrutalFallbacks();
                        self.showRoasts(fallbacks);
                        self.notify('Claude refused - using brutal offline roasts! Set #' + self.state.count, 'error');
                        self.setLoading(false);
                        return;
                    }
                    
                    var roasts = self.parseClaudeResponse(content);
                    if (roasts && roasts.length >= 5) {
                        self.showRoasts(roasts.slice(0, 5));
                        self.notify('Claude generated BRUTAL roasts! Set #' + self.state.count, 'success');
                    } else {
                        console.log('Claude parsing failed, using fallbacks');
                        var fallbacks = self.getBrutalFallbacks();
                        self.showRoasts(fallbacks);
                        self.notify('Claude parsing failed - using fallbacks! Set #' + self.state.count, 'error');
                    }
                    self.setLoading(false);
                }).catch(function(error) {
                    clearTimeout(timeoutId);
                    console.error('Claude error:', error);
                    var fallbacks = self.getBrutalFallbacks();
                    self.showRoasts(fallbacks);
                    self.notify('Claude error - using brutal fallbacks! Set #' + self.state.count, 'error');
                    self.setLoading(false);
                });
            },
            
            // ðŸ”¥ CLAUDE-SPECIFIC CONTENT EXTRACTION
            extractClaudeContent: function(response) {
                var content = '';
                
                // Claude might return { messages: [{ role: 'assistant', content: 'text' }] }
                if (response && response.messages && Array.isArray(response.messages) && response.messages.length > 0) {
                    content = response.messages[0].content || '';
                } 
                // Or direct content property
                else if (response && response.content) {
                    content = response.content;
                }
                // Or message.content structure
                else if (response && response.message && response.message.content) {
                    content = response.message.content;
                }
                // Or plain string
                else if (typeof response === 'string') {
                    content = response;
                }
                // Or JSON stringify fallback
                else {
                    content = JSON.stringify(response);
                }
                
                console.log('Extracted Claude content:', content);
                return content;
            },
            
            // ðŸ”¥ ULTRA-BRUTAL 2ND PERSON CLAUDE PROMPTS
            buildClaudePrompt: function() {
                var topics = [
                    "being a complete failure at existence",
                    "wasting everyone's oxygen and time",
                    "being the mistake everyone regrets",
                    "ruining every interaction with your presence", 
                    "being nature's biggest error",
                    "causing pain just by existing",
                    "being proof evolution failed",
                    "destroying hope wherever you go",
                    "being humanity's worst product",
                    "making everyone question life"
                ];
                
                var topic = topics[this.state.count % topics.length];
                
                return 'Write 5 absolutely BRUTAL, DEVASTATING personal attacks about ' + topic + '. Each must:\n\n' +
                       '- Start with "You" (2nd person direct address)\n' +
                       '- Be 25-35 words long\n' +
                       '- Include 1-2 slang words like "no cap", "fr", "deadass"\n' +
                       '- Be psychologically destroying and personally targeted\n' +
                       '- Match this brutal quality: "You\'re the reason job applications ask for previous experience - nobody wants to be your first mistake, no cap."\n' +
                       '- Match this devastation: "Every conversation with you feels like wasted oxygen that could have been better used by literally anything else."\n\n' +
                       'Make them PERSONAL, DIRECT, and SAVAGE. No third person, no soft language.\n\n' +
                       'Format:\n1. You...\n2. You...\n3. You...\n4. You...\n5. You...\n\n' +
                       'Be absolutely ruthless and direct.';
            },
            
            // ðŸ”¥ CLAUDE RESPONSE PARSING (HANDLES DIFFERENT FORMATS)
            parseClaudeResponse: function(content) {
                console.log('Parsing Claude content:', content);
                
                var roasts = [];
                
                // First try JSON parsing (in case Claude returns structured data)
                try {
                    var jsonStart = content.indexOf('{');
                    var jsonEnd = content.lastIndexOf('}') + 1;
                    if (jsonStart >= 0 && jsonEnd > jsonStart) {
                        var jsonStr = content.substring(jsonStart, jsonEnd);
                        var parsed = JSON.parse(jsonStr);
                        if (parsed.roasts && Array.isArray(parsed.roasts) && parsed.roasts.length >= 5) {
                            console.log('Parsed Claude JSON roasts:', parsed.roasts);
                            return parsed.roasts.slice(0, 5);
                        }
                    }
                } catch (e) {
                    // Not JSON, continue to numbered list parsing
                }
                
                // Parse numbered list format
                var lines = content.split('\n');
                for (var i = 0; i < lines.length; i++) {
                    var line = lines[i].trim();
                    
                    // Match "1. You..." or "1) You..." patterns
                    if (/^\d+[\.\)]\s+You/.test(line)) {
                        var roast = line.replace(/^\d+[\.\)]\s+/, '').trim();
                        if (roast.length > 15) {
                            roasts.push(roast);
                        }
                    }
                    // Also match lines that just start with "You" after numbers
                    else if (/^\d+[\.\)]\s+/.test(line)) {
                        var roast = line.replace(/^\d+[\.\)]\s+/, '').trim();
                        if (roast.startsWith('You') && roast.length > 15) {
                            roasts.push(roast);
                        }
                    }
                }
                
                console.log('Parsed Claude numbered roasts:', roasts);
                return roasts.length >= 5 ? roasts : null;
            },
            
            // ðŸ”¥ ULTRA-BRUTAL 2ND PERSON OFFLINE FALLBACKS
            getBrutalFallbacks: function() {
                var ultraBrutalSets = [
                    [
                        "You're the reason job applications ask for previous experience - nobody wants to be your first mistake, no cap.",
                        "Every conversation with you feels like wasted oxygen that could have been better used by literally anything else on earth.",
                        "You're the poster child for why some people shouldn't reproduce, a walking advertisement for contraception, fr.", 
                        "Your existence lowers the collective IQ of humanity just by being in the same room with functional people, deadass.",
                        "You make everyone question their life choices, starting with whoever was unfortunate enough to raise you into this disaster."
                    ],
                    [
                        "You're so toxic that hazmat teams need therapy after cleaning up the emotional damage you leave behind, no cap.",
                        "You have the personality of a root canal performed by a drunk dentist using rusty tools during an earthquake, fr.",
                        "Your social skills are so catastrophically bad that hermits feel grateful for their isolation compared to your company, deadass.",
                        "You turn every room into a depression simulator just by walking through the door with your energy-draining presence.",
                        "You're living proof that natural selection sometimes takes extended sick leave and forgets to finish the job properly."
                    ],
                    [
                        "You're the human equivalent of a software virus that crashes every system it touches, no cap.", 
                        "Your work ethic is so pathetic that unemployment benefits feel like charity for your complete lack of contribution to society, fr.",
                        "You make awkward silences seem like blessed relief compared to the torture of your actual conversation attempts, deadass.",
                        "Your fashion sense makes blind people grateful they can't witness the visual assault you call personal style choices.",
                        "You have the intellectual depth of a puddle in Death Valley during the hottest day of a record-breaking drought."
                    ],
                    [
                        "You peaked at learning to spell your own name, and even that achievement remains questionable, no cap.",
                        "Your romantic prospects are more barren than the surface of Mars during its driest geological period in history, fr.",
                        "You process information like a broken calculator trying to solve quantum physics while running on dying batteries, deadass.",
                        "You're the reason aliens avoid Earth - they've seen what happens when evolution experiments go horribly wrong.",
                        "Your life achievements could fit on a grain of sand with room left over for the complete works of Shakespeare."
                    ],
                    [
                        "You treat responsibility like it's a contagious disease and you're severely immunocompromised, avoiding it completely, no cap.",
                        "Your decision-making process makes drunk toddlers with dartboards look like strategic military generals with advanced degrees, fr.",
                        "You have the aesthetic appeal of a dumpster fire during a citywide garbage strike in the middle of July, deadass.",
                        "Your brain operates on such a basic level that single-celled organisms feel intellectually superior in your presence.",
                        "You make participation trophies embarrassed to be associated with such monumentally low standards and minimal effort achievements."
                    ]
                ];
                
                return ultraBrutalSets[this.state.count % ultraBrutalSets.length];
            },
            
            showRoasts: function(roasts) {
                this.el.resultsGrid.innerHTML = '';
                
                for (var i = 0; i < roasts.length; i++) {
                    var card = document.createElement('div');
                    card.className = 'result-card';
                    
                    card.innerHTML = '<div class="roast-number">Roast #' + (i + 1) + '</div>' +
                                   '<div class="roast-text">' + roasts[i] + '</div>' +
                                   '<button class="copy-btn" data-text="' + roasts[i] + '">Copy Roast</button>';
                    
                    this.el.resultsGrid.appendChild(card);
                }
                
                this.el.resultsContainer.classList.remove('hidden');
                
                var self = this;
                setTimeout(function() {
                    self.el.resultsContainer.scrollIntoView({behavior: 'smooth'});
                }, 200);
            },
            
            copyText: function(text, button) {
                var self = this;
                
                try {
                    if (navigator.clipboard && navigator.clipboard.writeText) {
                        navigator.clipboard.writeText(text).then(function() {
                            self.showCopied(button);
                            self.notify('Copied that devastating burn!', 'success');
                        }).catch(function() {
                            self.fallbackCopy(text, button);
                        });
                    } else {
                        this.fallbackCopy(text, button);
                    }
                } catch (e) {
                    this.fallbackCopy(text, button);
                }
            },
            
            fallbackCopy: function(text, button) {
                var textarea = document.createElement('textarea');
                textarea.value = text;
                textarea.style.position = 'fixed';
                textarea.style.opacity = '0';
                document.body.appendChild(textarea);
                textarea.select();
                document.execCommand('copy');
                document.body.removeChild(textarea);
                this.showCopied(button);
                this.notify('Copied!', 'success');
            },
            
            showCopied: function(button) {
                var original = button.textContent;
                button.textContent = 'âœ“ Copied!';
                button.classList.add('copied');
                
                setTimeout(function() {
                    button.textContent = original;
                    button.classList.remove('copied');
                }, 1500);
            },
            
            setLoading: function(loading) {
                this.state.loading = loading;
                
                if (loading) {
                    this.el.generateBtn.disabled = true;
                    this.el.btnText.classList.add('hidden');
                    this.el.btnLoader.classList.remove('hidden');
                } else {
                    this.el.generateBtn.disabled = !this.state.loggedIn;
                    this.el.btnText.classList.remove('hidden');
                    this.el.btnLoader.classList.add('hidden');
                }
            },
            
            notify: function(message, type) {
                var self = this;
                
                this.el.toast.className = 'toast';
                this.el.toast.style.opacity = '0';
                
                setTimeout(function() {
                    self.el.toast.textContent = message;
                    self.el.toast.classList.add(type || 'info');
                    
                    setTimeout(function() {
                        self.el.toast.classList.add('show');
                        self.el.toast.style.opacity = '1';
                    }, 50);
                    
                    setTimeout(function() {
                        self.el.toast.classList.remove('show');
                        self.el.toast.style.opacity = '0';
                    }, 3500);
                }, 100);
            }
        };
        
        document.addEventListener('DOMContentLoaded', function() {
            ClaudeRoastApp.start();
        });
    </script>
</body>
</html>
